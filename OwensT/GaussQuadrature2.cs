using MultiPrecision;
using System.Linq;

namespace OwensT {
    internal static partial class GaussQuadrature2<N> where N : struct, IConstant {

        public static MultiPrecision<N> T5r7(MultiPrecision<N> h, MultiPrecision<N> a) {
            MultiPrecision<N> h2 = h * h, n_half_h2 = -h2 / 2;

            MultiPrecision<N> ig = MultiPrecision<N>.Sqrt(MultiPrecision<N>.PI / 2) / h
                * MultiPrecision<N>.Exp(n_half_h2) * MultiPrecision<N>.Erf(h * a / MultiPrecision<N>.Sqrt2);

            MultiPrecision<N> x_peak = MultiPrecision<N>.Sqrt(MultiPrecision<N>.Sqrt(h2 + 8) / (2 * h) - MultiPrecision<N>.Point5);
            MultiPrecision<N> ap = MultiPrecision<N>.Min(a, x_peak * 2), ad = a - ap;

            MultiPrecision<N> sp = 0, sd = 0;

            for (int k = 0; k < gls.Length; k++) {
                (MultiPrecision<N> x, MultiPrecision<N> w) = gls[k];
                MultiPrecision<N> x_sft = x * ap;

                MultiPrecision<N> p = x_sft * x_sft;
                MultiPrecision<N> r = 1 + p;

                MultiPrecision<N> u = w * MultiPrecision<N>.Exp(n_half_h2 * r) * p / r;

                sp += u;
            }

            if (ad > 0) {
                for (int k = 0; k < gls.Length; k++) {
                    (MultiPrecision<N> x, MultiPrecision<N> w) = gls[k];
                    MultiPrecision<N> x_sft = x * ad + ap;

                    MultiPrecision<N> p = x_sft * x_sft;
                    MultiPrecision<N> r = 1 + p;

                    MultiPrecision<N> u = w * MultiPrecision<N>.Exp(n_half_h2 * r) * p / r;

                    sd += u;
                }
            }

            MultiPrecision<N> y = (ig - sp * ap - sd * ad) / (2 * MultiPrecision<N>.PI);

            return y;
        }

        public static MultiPrecision<N> T5r8(MultiPrecision<N> h, MultiPrecision<N> a) {
            MultiPrecision<N> h2 = h * h, n_half_h2 = -h2 / 2;

            MultiPrecision<N> ig = MultiPrecision<N>.Sqrt(MultiPrecision<N>.PI / 2) / h
                * MultiPrecision<N>.Exp(n_half_h2) * MultiPrecision<N>.Erf(h * a / MultiPrecision<N>.Sqrt2);

            MultiPrecision<N> x_peak = MultiPrecision<N>.Sqrt(MultiPrecision<N>.Sqrt(h2 + 8) / (2 * h) - MultiPrecision<N>.Point5);
            MultiPrecision<N> ap = MultiPrecision<N>.Min(a, x_peak * 2);
            MultiPrecision<N> ad = MultiPrecision<N>.Min(a - ap, x_peak * 6);

            MultiPrecision<N> sp = 0, sd = 0;

            for (int k = 0; k < gls.Length; k++) {
                (MultiPrecision<N> x, MultiPrecision<N> w) = gls[k];
                MultiPrecision<N> x_sft = x * ap;

                MultiPrecision<N> p = x_sft * x_sft;
                MultiPrecision<N> r = 1 + p;

                MultiPrecision<N> u = w * MultiPrecision<N>.Exp(n_half_h2 * r) * p / r;

                sp += u;
            }

            if (ad > 0) {
                for (int k = 0; k < gls.Length; k++) {
                    (MultiPrecision<N> x, MultiPrecision<N> w) = gls[k];
                    MultiPrecision<N> x_sft = x * ad + ap;

                    MultiPrecision<N> p = x_sft * x_sft;
                    MultiPrecision<N> r = 1 + p;

                    MultiPrecision<N> u = w * MultiPrecision<N>.Exp(n_half_h2 * r) * p / r;

                    sd += u;
                }
            }

            MultiPrecision<N> y = (ig - sp * ap - sd * ad) / (2 * MultiPrecision<N>.PI);

            return y;
        }

        static readonly (string x, string w)[] p25 = new (string, string)[] {
            ("0.002221515104750951045607526553049191371218675297595914394597534433533259328136032756355986823526496215658705647853722420088562755832180377627383976636131899107963759573645411155907340880325143256645441418004247286476435358341842425914729630613890970738486863280524159597297540128610018373589802252844608985","0.005696899250513143973951482056617386801660263146454848224474030558094945864883371677961838556472516752844215809004831871801138696480596148323850210126789381758483799031101439562993548983656174514180464962424427323960107437420228017843650937607985330923113957102965219155568163246120044607846632965463348965"),
            ("0.01166803927024124425084230676020296612731472234279662766450628634191806623205972305177664525849691066590067008472675912682171260267919216865409390528816051902659174265251401035162256285430950283105449262255189932702701106522271073463772460955016009574701345811652911636731396674573076083109903381800701269","0.013177493307516068630950907647649572467981640851661234377683082891935467004439749685764910764086464445175181232302551987271986648295038824674017185037277142606614821443622008762898480328327239968043992877250439713669344713627089441266536912602590502878797396702978337248420184768129226080173771769267645259") ,
            ("0.028512714385512830292994415170764734047399214695504929036273751431352338727975369345547390924363258364451666066672139203731281386526412878802910803446970005482855710062853648361332940823592952494777727197225985313355060920277644252079922431008606959771953251696089203490848413736834919502754544449789208044","0.020469578350653156327811743855822976830422891682052173252349207449648716440107756385239485527555212065061763507712755748584468108770937225702861399788255029767461465146178887380710433800844787373559338905952245190423911230254248619949752267909983471128622342217963199040699548410172779845913927375316849963"),
            ("0.052504001060862315574478996608597522912722575123208048469149158520414244549400274314406996534804109189531365586808521377806657558171837435511775498104760995892146166117723729680698962258905232825083121543207043456788003822713015217459239050120795821590375667178677029924743135137392491960596489273977935477","0.027452347987917595962968445770236662080054992776555674524254249122296887339218255947855962039716722381878373414408806313731603787014148981601160512747444275415098433238842936450524740726743971598275558430116587080281662691991631226965157108691662955117538438376486050167057341139353110869471807249551510001"),
            ("0.083278685619582999289489445653215215269517943088239606989567642269140933761454937373385130261204159464332544670313262552809197822912807408261275964179696675512852316822481380032781535149873627968689746352781961412198073283345782913313411558198730443177182676480337373799892210234020544016661320455246163066","0.034019166906178458603593592828353984277354747177318281307535613205001827025855736553325761484740936866549380880330449110596506855692987786283609954746747357005800649793322163411624859723658026541535693426177189156394775102952275225585171586141909208116999531085886071974118791042228002462450582392293675409"),
            ("0.12037036848132118471135856739781951180623899055083293954080513227749068558986879619618160137907384834268040206885463501212575326381009247362613571937431507064828684485412741889327688354537135777839510846380269226066193320311962706171857821496874664347949730230110980263553715975980624791399140692992302515","0.040070350167500509006617479834555651145112866426837946858100731486806414467400644779728688857112659024121978739662906482904202328592865763874894991267195543872639819686931752054683869884280462611595832915704095871856918067272462051620860170710316556728644206198637548820944157807140630261175020248440662646") ,
            ("0.16321681576326581775743968337618891205829163596362534147017151911085613157535789420901815715984533902977858925342805934644705960297918144958719042929719396730604205087379228592127934850636726322793913065936945410865897576102953226243788793561782934986634997219959025486792415397327755450171637844649965831","0.045514130991481824905748610351445826690496279479667155485241884483508692339205263451242199071476859442936260795425185868013374412787719341781231883010009095060175385680589944832820682900806757668801021821605131255220656541328695978476605120900624103324391378192615247661846671826939810884179573656509748896") ,
            ("0.21116853487938851613815507919367296630213248035424087167725824611948849362368398886164170176710175457993441966939709288318496234342078556236301756677950972692476770037189244075931106938272153016543721716403285025268996533313266528058073512991607484022089765494439759926393833502107837721533143048545362523","0.05026797453352532210110344519634291349423304726407095353493452099970647407952301484097782810186629105877613340603328889311118616626062043724593184218350987285986477171046441091115481444758540174366801401509491114348795811165941977654382907737574041051673045495948475974761010370052784366629465845417270849")  ,
            ("0.26349863427714251973890894249540397933409113076918635454638458615219836207935698494842157610860318227903606494647750957402606404305136445627078216578451693449095648372145293389009117671633935806943746939290777970711749223127076822272388485735907965592308665111309444592209008683467430161879255617282881936","0.054259812237131826558046978525058309670038793993361008078247153674419646396804221346698841750148270860679163867137825187022984990928300530022301665766171020729198541098727293516760287527395812231057098716389235100786458321691464750669849258569457322436179743758169079659726188426065606724820060794060019001") ,
            ("0.31941384709530608113208913493617966628896082647831246510271061107662730880215172569835234246953119299605352693938594059555374473130175099458834986578067240853784880128286934919163646669934413451452618453159996809370770284891595484593595632869776699341964207580346346786753679223818330084328812086099503166","0.057429129572855824169662772934777904320468095834090074795757495015741398335562711282672149492790781366252568261758717986294845985701561143052754543702500538848371549522223217242168411281492239977909501623805019953403147825125987157496242386387762762231775651571588333961524731357127918468820041629429829311") ,
            ("0.37806655813950578397740481860127420679718342183700776178943217337480626360707202466011181611837482969836225750117129194250450697887791417779348881488559826160779522609422618917265405408456952711985177864336372416656693156865830241601892238662805525527322737507379172958836056748839124328199467652718394131","0.059727881767892386114089063256450523695088350706863212759793940667592045110093867512214348604876356606871742842131173514124074795825704029821601192268664853512380721715898107822841482878095274198726077902162794304954246202310557199681478231665888357598028311702038109054229421270475697724346875503567643665") ,
            ("0.43856765369464480180632009059598159723389732697510813078805323105364558251557079208678057502683447231201117009793840096252100850684671578678626140821027440151734398472112731063320218198292947189337867958351487861575442121570826988931717327931061602571758163205733492815716313811322198019329915761458543444","0.061121221495155020844479759472925752917529623781529520453790041116019483609590051215167704455394533185578100784226521383945095556735064172424975412073439392877355891531401063382114835628135227942529532560061022719239210584586990512129713801876598034403327487870132951796524913781985087092875060212990482675") ,
            ("0.5","0.06158802686335772560195143653952507121911681375907583269567609865845600397463071064230056258752479188655027291972997130519706333382891123038161841456399299137310830080139354933740710377795724726023574368651380237264320633955790008354230627911896196919170220052211018342345956644746848262326397549787175144")                                                                                                                                                                                                                                                                                                                  ,
            ("0.56143234630535519819367990940401840276610267302489186921194676894635441748442920791321942497316552768798882990206159903747899149315328421321373859178972559848265601527887268936679781801707052810662132041648512138424557878429173011068282672068938397428241836794266507184283686188677801980670084238541456556","0.061121221495155020844479759472925752917529623781529520453790041116019483609590051215167704455394533185578100784226521383945095556735064172424975412073439392877355891531401063382114835628135227942529532560061022719239210584586990512129713801876598034403327487870132951796524913781985087092875060212990482675") ,
            ("0.62193344186049421602259518139872579320281657816299223821056782662519373639292797533988818388162517030163774249882870805749549302112208582220651118511440173839220477390577381082734594591543047288014822135663627583343306843134169758398107761337194474472677262492620827041163943251160875671800532347281605869","0.059727881767892386114089063256450523695088350706863212759793940667592045110093867512214348604876356606871742842131173514124074795825704029821601192268664853512380721715898107822841482878095274198726077902162794304954246202310557199681478231665888357598028311702038109054229421270475697724346875503567643665") ,
            ("0.68058615290469391886791086506382033371103917352168753489728938892337269119784827430164765753046880700394647306061405940444625526869824900541165013421932759146215119871713065080836353330065586548547381546840003190629229715108404515406404367130223300658035792419653653213246320776181669915671187913900496834","0.057429129572855824169662772934777904320468095834090074795757495015741398335562711282672149492790781366252568261758717986294845985701561143052754543702500538848371549522223217242168411281492239977909501623805019953403147825125987157496242386387762762231775651571588333961524731357127918468820041629429829311") ,
            ("0.73650136572285748026109105750459602066590886923081364545361541384780163792064301505157842389139681772096393505352249042597393595694863554372921783421548306550904351627854706610990882328366064193056253060709222029288250776872923177727611514264092034407691334888690555407790991316532569838120744382717118064","0.054259812237131826558046978525058309670038793993361008078247153674419646396804221346698841750148270860679163867137825187022984990928300530022301665766171020729198541098727293516760287527395812231057098716389235100786458321691464750669849258569457322436179743758169079659726188426065606724820060794060019001") ,
            ("0.78883146512061148386184492080632703369786751964575912832274175388051150637631601113835829823289824542006558033060290711681503765657921443763698243322049027307523229962810755924068893061727846983456278283596714974731003466686733471941926487008392515977910234505560240073606166497892162278466856951454637477","0.05026797453352532210110344519634291349423304726407095353493452099970647407952301484097782810186629105877613340603328889311118616626062043724593184218350987285986477171046441091115481444758540174366801401509491114348795811165941977654382907737574041051673045495948475974761010370052784366629465845417270849")  ,
            ("0.83678318423673418224256031662381108794170836403637465852982848088914386842464210579098184284015466097022141074657194065355294039702081855041280957070280603269395794912620771407872065149363273677206086934063054589134102423897046773756211206438217065013365002780040974513207584602672244549828362155350034169","0.045514130991481824905748610351445826690496279479667155485241884483508692339205263451242199071476859442936260795425185868013374412787719341781231883010009095060175385680589944832820682900806757668801021821605131255220656541328695978476605120900624103324391378192615247661846671826939810884179573656509748896") ,
            ("0.87962963151867881528864143260218048819376100944916706045919486772250931441013120380381839862092615165731959793114536498787424673618990752637386428062568492935171315514587258110672311645462864222160489153619730773933806679688037293828142178503125335652050269769889019736446284024019375208600859307007697485","0.040070350167500509006617479834555651145112866426837946858100731486806414467400644779728688857112659024121978739662906482904202328592865763874894991267195543872639819686931752054683869884280462611595832915704095871856918067272462051620860170710316556728644206198637548820944157807140630261175020248440662646") ,
            ("0.91672131438041700071051055434678478473048205691176039301043235773085906623854506262661486973879584053566745532968673744719080217708719259173872403582030332448714768317751861996721846485012637203131025364721803858780192671665421708668658844180126955682281732351966262620010778976597945598333867954475383693","0.034019166906178458603593592828353984277354747177318281307535613205001827025855736553325761484740936866549380880330449110596506855692987786283609954746747357005800649793322163411624859723658026541535693426177189156394775102952275225585171586141909208116999531085886071974118791042228002462450582392293675409") ,
            ("0.94749599893913768442552100339140247708727742487679195153085084147958575545059972568559300346519589081046863441319147862219334244182816256448822450189523900410785383388227627031930103774109476717491687845679295654321199617728698478254076094987920417840962433282132297007525686486260750803940351072602206452","0.027452347987917595962968445770236662080054992776555674524254249122296887339218255947855962039716722381878373414408806313731603787014148981601160512747444275415098433238842936450524740726743971598275558430116587080281662691991631226965157108691662955117538438376486050167057341139353110869471807249551510001") ,
            ("0.97148728561448716970700558482923526595260078530449507096372624856864766127202463065445260907563674163554833393332786079626871861347358712119708919655302999451714428993714635163866705917640704750522227280277401468664493907972235574792007756899139304022804674830391079650915158626316508049724545555021079196","0.020469578350653156327811743855822976830422891682052173252349207449648716440107756385239485527555212065061763507712755748584468108770937225702861399788255029767461465146178887380710433800844787373559338905952245190423911230254248619949752267909983471128622342217963199040699548410172779845913927375316849963") ,
            ("0.98833196072975875574915769323979703387268527765720337233549371365808193376794027694822335474150308933409932991527324087317828739732080783134590609471183948097340825734748598964837743714569049716894550737744810067297298893477728926536227539044983990425298654188347088363268603325426923916890096618199298731","0.013177493307516068630950907647649572467981640851661234377683082891935467004439749685764910764086464445175181232302551987271986648295038824674017185037277142606614821443622008762898480328327239968043992877250439713669344713627089441266536912602590502878797396702978337248420184768129226080173771769267645259") ,
            ("0.99777848489524904895439247344695080862878132470240408560540246556646674067186396724364401317647350378434129435214627757991143724416781962237261602336386810089203624042635458884409265911967485674335455858199575271352356464165815757408527036938610902926151313671947584040270245987138998162641019774715539102","0.0056968992505131439739514820566173868016602631464548482244740305580949458648833716779618385564725167528442158090048318718011386964805961483238502101267893817584837990311014395629935489836561745141804649624244273239601074374202280178436509376079853309231139571029652191555681632461200446078466329654633489651"),
        };

        static readonly (MultiPrecision<N> x, MultiPrecision<N> w)[] gls
            = p25.Select((v) => ((MultiPrecision<N>)v.x, (MultiPrecision<N>)v.w)).ToArray();
    }
}
